<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leda Heavy Industry</title>
    <link rel="icon" type="image/png" href="pages/assets/image/web_icon.png">
    <link rel="stylesheet" href="pages/style.css">
    <style>
        /* All button/link styles from here have been moved to links.html */
    </style>
</head>
<body>
    <!-- Audio Player (Plays continuously) -->
    <audio id="background-audio" controls autoplay loop style="display:none;">
        <source src="pages/assets/audio/purple.mp3" type="audio/mp3">
        Your browser does not support the audio tag.
    </audio>
    
    <!-- UI Sound (Hidden, plays on navigation clicks) -->
    <audio id="ui-sound" preload="auto" style="display:none;">
        <source src="pages/assets/audio/ui_sound.wav" type="audio/wav">
    </audio>
    
    <!-- Fixed width wrapper for the entire layout -->
    <div class="layout-wrapper">
        <!-- Left Navigation Sidebar -->
        <div class="sidebar left-sidebar">
            <a href="pages/home.html" target="content-frame">home</a>
            <h2>the craft</h2>
            <a href="pages/paintings.html" target="content-frame">paintings</a>
            <a href="pages/gamedev.html" target="content-frame">gamedev</a>
            <a href="pages/music.html" target="content-frame">music</a>
            <a href="pages/film-photography.html" target="content-frame">film photography</a>
            <a href="pages/drawings.html" target="content-frame">drawings</a>
            <a href="pages/links.html" target="content-frame">links</a>
            <a href="pages/hub.html" target="content-frame">secret ⵙⵙⴻⵔ</a>
            <h2></h2>
            <a href="pages/credits.html" target="content-frame">terms and services</a>
            <a href="rss.xml" target="_blank">changelog rss</a>

        </div>
        
        <!-- Content Area (Loads subpages) -->
        <div class="content">
            <iframe name="content-frame" src="pages/home.html"></iframe>
        </div>
        
        <!-- Right Navigation Sidebar -->
        <div class="sidebar right-sidebar">
            <a href="pages/guestbook.html" target="content-frame">guestbook</a>
            <h2>the soul</h2>
            <a href="pages/thoughts.html" target="content-frame">my thoughts are drowning on the horizon</a>
            <a href="pages/liked_music.html" target="content-frame">transistors amplify my dreams</a>
            <a href="pages/liked_dreams.html" target="content-frame">i have sheltered all the dreams of the world</a>
            <a href="pages/liked_poems.html" target="content-frame">words to pierce the beyond. words to which I will survive</a>
            <h2></h2>

            <!-- All content below h2 has been moved to links.html -->

        </div>
    </div>
    
    <script>
        // Set background music volume
        document.getElementById('background-audio').volume = 0.5; // Sets volume to 50%. Don't forget to change the displayed value in the home page as well
        
        // UI Sound on navigation clicks (progressive enhancement)
        // Site works perfectly without this - just adds sound when JS is enabled
        const uiSound = document.getElementById('ui-sound');
        const sidebarLinks = document.querySelectorAll('.sidebar a');
        
        sidebarLinks.forEach(link => {
            link.addEventListener('click', function() {
                if (uiSound) {
                    uiSound.currentTime = 0; // Reset to start for rapid clicks
                    uiSound.play().catch(() => {}); // Ignore play errors
                }
            });
        });
        
        // URL Parameter System for Shareable Links
        // Maps page names to their file paths
        const pageMap = {
            'home': 'pages/home.html',
            'paintings': 'pages/paintings.html',
            'gamedev': 'pages/gamedev.html',
            'music': 'pages/music.html',
            'film-photography': 'pages/film-photography.html',
            'drawings': 'pages/drawings.html',
            'links': 'pages/links.html',
            'credits': 'pages/credits.html',
            'guestbook': 'pages/guestbook.html',
            'thoughts': 'pages/thoughts.html',
            'liked_music': 'pages/liked_music.html',
            'liked_dreams': 'pages/liked_dreams.html',
            'liked_poems': 'pages/liked_poems.html'
        };
        
        // Function to load page from URL parameter
        function loadPageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const page = urlParams.get('page');
            
            if (page && pageMap[page]) {
                const iframe = document.querySelector('iframe[name="content-frame"]');
                if (iframe) {
                    iframe.src = pageMap[page];
                }
            }
        }
        
        // Function to update URL when navigation links are clicked
        function setupNavigationLinks() {
            const navLinks = document.querySelectorAll('.sidebar a[target="content-frame"]');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    
                    // Find the page name from the href
                    let pageName = null;
                    for (const [name, path] of Object.entries(pageMap)) {
                        if (href === path) {
                            pageName = name;
                            break;
                        }
                    }
                    
                    // Update URL if we found a matching page
                    if (pageName) {
                        const newURL = window.location.pathname + '?page=' + pageName;
                        window.history.pushState({page: pageName}, '', newURL);
                    }
                });
            });
        }
        
        // Handle browser back/forward buttons
        window.addEventListener('popstate', function(event) {
            loadPageFromURL();
        });
        
        // Initialize when page loads
        window.addEventListener('load', function() {
            loadPageFromURL();
            setupNavigationLinks();
        });
    </script>      

</body>
</html>